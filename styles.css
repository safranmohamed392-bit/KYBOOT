:root{
    /* Modern Color Palette */
    --bg: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 50%, #e2e8f0 100%);
    --bg-solid: #f8fafc;
    --card: #ffffff;
    --card-hover: #fdfdfe;
    --muted: #64748b;
    --text-primary: #0f172a;
    --text-secondary: #475569;
    
    /* Vibrant Accent Colors */
    --accent: #3b82f6;
    --accent-secondary: #8b5cf6;
    --accent-tertiary: #06b6d4;
    --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #06b6d4 100%);
    --accent-soft: rgba(59, 130, 246, 0.1);
    
    /* Success & Status Colors */
    --success: #10b981;
    --warning: #f59e0b;
    --error: #ef4444;
    
    /* Layout & Effects */
    --maxw: 1200px;
    --radius: 16px;
    --radius-sm: 8px;
    --radius-lg: 24px;
    
    /* Enhanced Shadows */
    --shadow-sm: 0 2px 8px rgba(15, 23, 42, 0.04);
    --shadow: 0 8px 25px rgba(15, 23, 42, 0.08);
    --shadow-lg: 0 16px 40px rgba(15, 23, 42, 0.12);
    --shadow-hover: 0 20px 60px rgba(15, 23, 42, 0.15);
    --shadow-colored: 0 8px 32px rgba(59, 130, 246, 0.3);
    
    /* Advanced Transitions */
    --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    --transition-bounce: 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    
    /* Typography */
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
    font-optical-sizing: auto;
  }
  /* Glass mode overrides (applied via body.glass-mode) */
  body.glass-mode {
    --bg: radial-gradient(circle at 30% 30%, rgba(59,130,246,0.10), transparent 58%),
          radial-gradient(circle at 70% 70%, rgba(139,92,246,0.08), transparent 62%),
          linear-gradient(135deg,#0f172a 0%, #182638 42%, #1f2f44 62%, #273a50 85%, #334155 100%);
    --bg-solid:#0f172a;
    --card: rgba(255,255,255,0.14);
    --card-hover: rgba(255,255,255,0.20);
    --text-primary: #f8fafc;
    --text-secondary: #d2dcea;
    --muted: #9dacbb;
    --shadow-sm: 0 2px 8px rgba(0,0,0,0.45);
    --shadow: 0 8px 28px rgba(0,0,0,0.6);
    --shadow-lg: 0 18px 42px rgba(0,0,0,0.65);
    --shadow-hover: 0 26px 72px -12px rgba(0,0,0,0.78);
    color-scheme: dark;
  }
  body.glass-mode .site-header,
  body.glass-mode .site-footer,
  body.glass-mode .stats,
  body.glass-mode .card,
  body.glass-mode .cart-panel,
  body.glass-mode .btn,
  body.glass-mode .search-area input {
    backdrop-filter: blur(18px) saturate(160%);
    -webkit-backdrop-filter: blur(18px) saturate(160%);
  }
  /* Toned & isolated overlay for hero in glass mode */
  body.glass-mode .hero { isolation:isolate; }
  body.glass-mode .hero::after {
    content:'';
    position:absolute; left:0; right:0; bottom:-140px;
    height:240px; z-index:0;
    background:
      radial-gradient(ellipse at center, rgba(255,255,255,0.38) 0%, rgba(255,255,255,0.12) 45%, rgba(255,255,255,0) 72%);
    pointer-events:none;
    filter: blur(18px) saturate(140%);
    opacity:.45;
    mix-blend-mode: normal;
  }
  body.glass-mode .hero > * { position:relative; z-index:1; }
  body.glass-mode .products-grid { margin-top: 0; padding-top: 120px; }
  body.glass-mode .products-grid::before {
    content:''; position:absolute; left:0; right:0; top:0; height:160px; pointer-events:none; z-index:0;
    background: linear-gradient(to bottom, rgba(255,255,255,0.15), rgba(255,255,255,0) 90%);
    mix-blend-mode: normal; filter: blur(6px); opacity:.7;
  }
  body.glass-mode .hero h1,
  body.glass-mode .hero p { text-shadow: 0 2px 6px rgba(0,0,0,0.25); }
  body.glass-mode .card,
  body.glass-mode .stats,
  body.glass-mode .cart-panel,
  body.glass-mode .btn { border:1px solid rgba(255,255,255,0.15); }
  body.glass-mode .hero { background: radial-gradient(circle at center, rgba(255,255,255,0.05) 0%, transparent 70%); }
  body.glass-mode .brand { filter: drop-shadow(0 4px 18px rgba(59,130,246,0.6)); }
  body.glass-mode .site-footer { background: linear-gradient(135deg, rgba(30,41,59,0.7), rgba(15,23,42,0.7)); }
  body.glass-mode .cart-header { background: var(--accent-gradient); }
  body.glass-mode .bg-fx { mix-blend-mode: normal; opacity:0.9; }
  body.glass-mode .mode-toggle { background: var(--accent-gradient); color:#fff; }

  /* --- Minimal readability tweak per user request: only increase weight --- */
  body.glass-mode .hero p { font-weight: 600; }
  body.glass-mode .stats { font-weight: 700; }
  body.glass-mode .actions select { font-weight: 600; color:#1e293b; }
  body.glass-mode #resultsCount { font-weight: 800; }
  body.glass-mode .hero .badge { font-weight:700; }

  /* Mode toggle button */
  .mode-toggle { position:relative; }
  /* Base (legacy fallback styles if .ios-switch not applied) */
  .mode-toggle:not(.ios-switch) {
    padding: 10px 14px;
    border-radius: var(--radius);
    border: 2px solid rgba(59,130,246,0.2);
    background: rgba(255,255,255,0.85);
    font-weight:600;
    cursor: pointer;
    box-shadow: var(--shadow-sm);
    transition: all var(--transition-bounce);
  }
  .mode-toggle:not(.ios-switch):hover { transform: translateY(-3px); box-shadow: var(--shadow); }
  .mode-toggle:not(.ios-switch):active { transform: translateY(-1px); }
  .mode-toggle:not(.ios-switch)[aria-pressed="true"] { background: var(--accent-gradient); color:#fff; border-color:transparent; box-shadow: var(--shadow-colored); }

  /* iOS style switch */
  .mode-toggle.ios-switch {
    width: 54px; height: 30px; padding:0; border:none; background:transparent; border-radius:999px; cursor:pointer;
    display:inline-flex; align-items:center; justify-content:flex-start; box-shadow:none; outline:none; -webkit-tap-highlight-color:transparent;
  }
  .mode-toggle.ios-switch .track { position:absolute; inset:0; background:linear-gradient(#eef2f6,#f8fafc); border-radius:inherit; box-shadow:0 0 0 1px rgba(0,0,0,0.08) inset, 0 4px 8px rgba(0,0,0,0.08); transition: background .35s var(--transition-normal), box-shadow .35s var(--transition-normal); }
  .mode-toggle.ios-switch .thumb { position:relative; width:26px; height:26px; margin-left:2px; background:#fff; border-radius:50%; box-shadow:0 2px 4px rgba(0,0,0,0.25),0 0 0 1px rgba(0,0,0,0.05); transition: transform .38s var(--transition-bounce), box-shadow .35s, background .35s; will-change: transform; }
  .mode-toggle.ios-switch.on .track { background: var(--accent-gradient); box-shadow: 0 0 0 1px rgba(59,130,246,0.4) inset, 0 6px 18px -4px rgba(59,130,246,0.55); }
  .mode-toggle.ios-switch.on .thumb { transform: translateX(24px); box-shadow:0 3px 8px rgba(59,130,246,0.55), 0 0 0 1px rgba(255,255,255,0.6); }
  .mode-toggle.ios-switch:active .thumb { box-shadow:0 2px 4px rgba(0,0,0,0.3),0 0 0 1px rgba(0,0,0,0.06); }
  .mode-toggle.ios-switch:hover .thumb { box-shadow:0 4px 10px rgba(0,0,0,0.28); }
  .mode-toggle.ios-switch:focus-visible .track { outline:3px solid var(--accent); outline-offset:3px; }
  /* Glass mode adjustments */
  body.glass-mode .mode-toggle.ios-switch .track { background: rgba(255,255,255,0.15); box-shadow:0 0 0 1px rgba(255,255,255,0.25) inset, 0 4px 14px -4px rgba(0,0,0,0.55); }
  body.glass-mode .mode-toggle.ios-switch.on .track { background: var(--accent-gradient); }
  /* Optional subtle icon using gradients */
  .mode-toggle.ios-switch .thumb::after { content:''; position:absolute; inset:0; border-radius:50%; background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.95), rgba(255,255,255,0)); mix-blend-mode: overlay; }
  .mode-toggle.ios-switch.on .thumb::after { background: radial-gradient(circle at 70% 70%, rgba(255,255,255,0.9), rgba(255,255,255,0)); }
  /* High contrast preference */
  @media (prefers-contrast: more) { .mode-toggle.ios-switch .track { box-shadow:0 0 0 2px rgba(0,0,0,0.4) inset; } }
  /* Reduce motion: disable thumb slide animation */
  @media (prefers-reduced-motion: reduce) { .mode-toggle.ios-switch .thumb { transition:none; } }

  /* Visually hidden utility */
  .visually-hidden { position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0; }

  /* Parallax / tilt wrapper (cards) */
  .tilt { will-change: transform; transform-style: preserve-3d; transition: transform .6s var(--transition-slow), box-shadow .4s; perspective: 800px; }
  .tilt[data-tilting="true"] { transition: none; }
  .tilt-inner { transform: translateZ(40px); }
  .card.tilt { background-clip: padding-box; }
  .card.tilt:hover { box-shadow: var(--shadow-hover), 0 0 0 1px rgba(255,255,255,0.05) inset; }
  body.glass-mode .card.tilt:hover { box-shadow: 0 25px 80px -10px rgba(0,0,0,0.85), 0 0 0 1px rgba(255,255,255,0.08) inset; }
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  html {
    scroll-behavior: smooth;
    font-size: 16px;
  }
  
  html, body {
    height: 100%;
  }
  
  body {
    margin: 0;
    background: var(--bg);
    color: var(--text-primary);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    line-height: 1.6;
    animation: pageLoad 1.2s var(--transition-slow) both;
    overflow-x: hidden;
  }

    /* Animated ambient background container (layered orbs + mesh gradient) */
    .bg-fx {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 0; /* was -10; raised so animated layers are visible */
      pointer-events: none;
      background:
        radial-gradient(circle at 20% 25%, rgba(59,130,246,0.18), transparent 60%),
        radial-gradient(circle at 80% 70%, rgba(139,92,246,0.18), transparent 65%),
        radial-gradient(circle at 65% 30%, rgba(6,182,212,0.16), transparent 60%),
        linear-gradient(135deg,#f1f5f9 0%, #f8fafc 30%, #f1f5f9 60%, #e2e8f0 100%);
      mix-blend-mode: normal;
      animation: bgShift 18s ease-in-out infinite alternate;
    }

    /* Floating translucent orbs (generated via JS) */
    .bg-fx .orb {
      position: absolute;
      width: var(--size,220px);
      aspect-ratio: 1/1;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9), rgba(255,255,255,0.05));
      box-shadow:
        0 0 0 1px rgba(255,255,255,0.2) inset,
        0 8px 40px -10px rgba(59,130,246,0.25),
        0 2px 10px -2px rgba(15,23,42,0.15);
      filter: blur(2px) saturate(140%);
      opacity: var(--o,0.45);
      animation: floatOrb var(--dur,22s) var(--delay,0s) linear infinite;
      backdrop-filter: blur(6px);
    }

    @keyframes floatOrb {
      0% { transform: translate3d(var(--xStart), var(--yStart),0) scale(1) rotate(0deg); }
      50% { transform: translate3d(calc(var(--xStart) + var(--xDrift)), calc(var(--yStart) + var(--yDrift)),0) scale(1.08) rotate(120deg); }
      100% { transform: translate3d(var(--xStart), var(--yStart),0) scale(1) rotate(360deg); }
    }

    @keyframes bgShift {
      0% { filter: hue-rotate(0deg) brightness(1); }
      50% { filter: hue-rotate(25deg) brightness(1.04); }
      100% { filter: hue-rotate(-25deg) brightness(1); }
    }

    /* Hero badge */
    .hero .badge {
      display: inline-block;
      padding: 6px 14px 6px 12px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      border-radius: 40px;
      background: rgba(255,255,255,0.65);
      backdrop-filter: blur(10px) saturate(160%);
      box-shadow: 0 4px 16px -6px rgba(15,23,42,0.25), 0 0 0 1.5px rgba(255,255,255,0.8) inset;
      color: var(--text-secondary);
      position: relative;
      animation: slideInUp 0.9s var(--transition-slow) 0.4s both;
    }
    .hero .badge.glow::after {
      content:'';
      position:absolute; inset:-2px; border-radius:inherit; padding:2px;
      background: var(--accent-gradient);
      mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      mask-composite: exclude;
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      animation: pulse 4s ease-in-out infinite;
      opacity:.65;
    }

    /* Reduced motion fallback */
    @media (prefers-reduced-motion: reduce) {
      .bg-fx { animation: none; }
      .bg-fx .orb { animation: none; }
    }

  body.no-scroll {
    overflow: hidden;
    touch-action: none;
  }

  /* Cursor ripple (legacy comment) */
  /* Sprinting butterflies trail (replaces streak trail) */
  .bg-fx .butterfly {
    position:absolute;
    top:0; left:0;
    width:18px; height:14px;
    pointer-events:none;
    transform: translate(-50%, -50%) rotate(var(--r,0deg)) scale(var(--s,1));
    animation: butterflyFlight var(--life,900ms) ease-out forwards;
    mix-blend-mode: screen;
    filter: brightness(1.15) saturate(1.5) drop-shadow(0 0 4px hsla(var(--h1,210),90%,70%,.55));
    will-change: transform, opacity;
  }
  /* wings */
  .bg-fx .butterfly::before,
  .bg-fx .butterfly::after {
    content:"";
    position:absolute;
    top:50%; left:50%;
    width:12px; height:14px;
    border-radius:60% 60% 45% 45%;
    background: radial-gradient(circle at 30% 35%, rgba(255,255,255,.9), rgba(255,255,255,0) 60%),
               radial-gradient(circle at 60% 60%, hsla(var(--h1,210),85%,70%,.85), hsla(var(--h2,260),70%,55%,0) 70%);
    transform-origin: 0% 50%;
    animation: wingFlap var(--flap,420ms) ease-in-out infinite;
    mix-blend-mode: overlay;
  }
  .bg-fx .butterfly::before { transform: translate(-50%, -50%) rotateY(0deg) rotateZ(-8deg); }
  .bg-fx .butterfly::after {
    transform: translate(-50%, -50%) scaleX(-1) rotateZ(8deg);
  }
  @keyframes wingFlap {
    0%,100% { transform: translate(-50%, -50%) rotateY(0deg) rotateZ(var(--z, -8deg)); }
    50% { transform: translate(-50%, -50%) rotateY(55deg) rotateZ(var(--z, -8deg)); }
  }
  @keyframes butterflyFlight {
    0% { opacity:0; transform: translate(-50%, -50%) translate(var(--ox,0), var(--oy,0)) rotate(var(--r,0deg)) scale(var(--s,1)); }
    10% { opacity:1; }
    70% { opacity:.95; }
    100% { opacity:0; transform: translate(-50%, -50%) translate(calc(var(--ox,0) + var(--dx,0px)), calc(var(--oy,0) + var(--dy,-40px))) rotate(calc(var(--r,0deg) + 25deg)) scale(calc(var(--s,1) * .8)); }
  }

  /* --- Enhanced Cursor FX: follower glow + sparks --- */
  .bg-fx .cursor-core {
    position: fixed;
    top:0; left:0;
    width:42px; height:42px;
    margin:0; padding:0;
    pointer-events:none;
    border-radius:50%;
    background:
      radial-gradient(circle at 30% 30%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.15) 55%, rgba(255,255,255,0) 70%),
      radial-gradient(circle at 65% 65%, rgba(59,130,246,0.9), rgba(139,92,246,0.35), rgba(6,182,212,0) 70%);
    mix-blend-mode: screen;
    filter: blur(4px) saturate(160%);
    transform: translate(-50%, -50%) scale(0.85);
    transition: opacity .35s ease;
    opacity:.85;
    z-index:2;
  }
  body.glass-mode .bg-fx .cursor-core { mix-blend-mode: lighten; filter: blur(5px) saturate(190%); }
  .bg-fx .cursor-core.hidden { opacity:0; }
  .bg-fx .cursor-core::after {
    content:''; position:absolute; inset:-8px; border-radius:inherit;
    background: conic-gradient(from 0deg, rgba(59,130,246,0.4), rgba(139,92,246,0.25), rgba(6,182,212,0.4), rgba(59,130,246,0.4));
    animation: spinCore 6s linear infinite;
    mix-blend-mode: overlay; opacity:.4; filter: blur(14px);
  }
  @keyframes spinCore { to { transform: rotate(360deg); } }

  .bg-fx .spark {
    position: fixed; top:0; left:0;
    width:10px; height:10px; pointer-events:none; border-radius:50%;
    background: radial-gradient(circle at 40% 40%, rgba(255,255,255,0.95), rgba(255,255,255,0.05) 65%);
    box-shadow: 0 0 8px -1px rgba(255,255,255,0.9), 0 0 24px -4px rgba(59,130,246,0.7);
    animation: sparkFly var(--dur,700ms) cubic-bezier(.45,.2,.2,.9) forwards;
    mix-blend-mode: screen;
    filter: brightness(1.2) saturate(180%);
  }
  .bg-fx .spark::after { content:''; position:absolute; inset:0; border-radius:inherit; background: radial-gradient(circle at center, rgba(59,130,246,0.7), rgba(139,92,246,0) 70%); opacity:.6; }
  @keyframes sparkFly {
    0% { transform: translate(var(--x,0), var(--y,0)) scale(.65); opacity:1; }
    70% { opacity:.9; }
    100% { transform: translate(calc(var(--x,0) * 4), calc(var(--y,0) * 4)) scale(0); opacity:0; }
  }

  @media (prefers-reduced-motion: reduce) {
    .bg-fx .cursor-core, .bg-fx .spark, .bg-fx .streak { animation: none !important; transition: none !important; }
  }
  
  /* Enhanced Page Load Animation */
  @keyframes pageLoad {
    0% { 
      opacity: 0;
      transform: translateY(20px);
      filter: blur(10px);
    }
    50% {
      opacity: 0.3;
      transform: translateY(10px);
      filter: blur(5px);
    }
    100% { 
      opacity: 1;
      transform: translateY(0);
      filter: blur(0px);
    }
  }

  /* Advanced Animation Library */
  @keyframes fadeIn {
    from { 
      opacity: 0;
    }
    to { 
      opacity: 1;
    }
  }

  @keyframes slideInUp {
    from { 
      opacity: 0;
      transform: translateY(40px);
    }
    to { 
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInLeft {
    from { 
      opacity: 0;
      transform: translateX(-40px);
    }
    to { 
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideInRight {
    from { 
      opacity: 0;
      transform: translateX(40px);
    }
    to { 
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.8);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes pulse {
    0%, 100% { 
      transform: scale(1);
      opacity: 1;
    }
    50% { 
      transform: scale(1.05);
      opacity: 0.8;
    }
  }

  @keyframes bounce {
    0%, 20%, 53%, 80%, 100% { 
      transform: translateY(0) rotate(0deg);
    }
    40%, 43% { 
      transform: translateY(-10px) rotate(-2deg);
    }
    70% { 
      transform: translateY(-5px) rotate(1deg);
    }
  }

  @keyframes float {
    0%, 100% { 
      transform: translateY(0px) rotate(0deg);
    }
    50% { 
      transform: translateY(-10px) rotate(1deg);
    }
  }

  @keyframes shimmer {
    0% {
      background-position: -200px 0;
    }
    100% {
      background-position: calc(200px + 100%) 0;
    }
  }

  @keyframes glow {
    0%, 100% {
      box-shadow: 0 0 5px var(--accent), 0 0 10px var(--accent), 0 0 15px var(--accent);
    }
    50% {
      box-shadow: 0 0 10px var(--accent), 0 0 20px var(--accent), 0 0 30px var(--accent);
    }
  }
  
  
  .container {
    width: 94%;
    max-width: var(--maxw);
    margin: 0 auto;
    padding: 0 16px;
  }
  
  /* Enhanced Controls Section */
  .controls {
    margin: 24px 0;
    animation: slideInUp 1s var(--transition-slow) 1.1s both;
  }
  
  .stats {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    padding: 16px 24px;
    border-radius: var(--radius-lg);
    border: 1px solid rgba(59, 130, 246, 0.1);
    font-weight: 600;
    color: var(--text-secondary);
    box-shadow: var(--shadow-sm);
    transition: all var(--transition-normal);
    display: inline-block;
  }
  
  .stats:hover {
    background: white;
    box-shadow: var(--shadow);
    transform: translateY(-2px);
  }
  
  #resultsCount {
    color: var(--accent);
    font-weight: 700;
  }
  
  /* Enhanced Header */
  .site-header, header {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px) saturate(180%);
    border-bottom: 1px solid rgba(59, 130, 246, 0.1);
    position: sticky;
    top: 0;
    z-index: 10; /* above bg-fx(0) */
    transition: all var(--transition-normal);
    animation: slideInUp 0.8s var(--transition-slow) both;
    box-shadow: var(--shadow-sm);
  }
  
  .site-header:hover {
    background: rgba(255, 255, 255, 0.98);
    box-shadow: var(--shadow);
    transform: translateY(-1px);
  }
  
  .site-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--accent-gradient);
    opacity: 0;
    transition: opacity var(--transition-normal);
  }
  
  .site-header:hover::before {
    opacity: 1;
  }
  .header-inner {
    display: flex;
    gap: 16px;
    align-items: center;
    padding: 16px 0;
    position: relative;
  }
  
  .brand {
    font-weight: 800;
    font-size: 24px;
    text-decoration: none;
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    transition: all var(--transition-bounce);
    animation: slideInLeft 1s var(--transition-slow) both;
    position: relative;
    letter-spacing: -0.02em;
  }
  
  .brand::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--accent-gradient);
    transition: width var(--transition-bounce);
  }
  
  .brand:hover {
    transform: scale(1.05) translateY(-2px);
    filter: drop-shadow(0 4px 12px rgba(59, 130, 246, 0.4));
  }
  
  .brand:hover::after {
    width: 100%;
  }
  
  .brand .dot {
    color: var(--accent);
    animation: bounce 2s infinite;
    animation-delay: 1.5s;
    display: inline-block;
    transform-origin: center bottom;
  }
  
  /* Enhanced Search */
  .search-area {
    flex: 1;
    animation: slideInUp 1s var(--transition-slow) 0.3s both;
    position: relative;
  }
  
  .search-area::before {
    content: '🔍';
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    z-index: 1;
    transition: all var(--transition-normal);
  }
  
  .search-area input {
    width: 100%;
    padding: 14px 16px 14px 40px;
    border-radius: var(--radius);
    border: 2px solid transparent;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    font-size: 15px;
    transition: all var(--transition-normal);
    box-shadow: var(--shadow-sm);
  }
  
  .search-area input::placeholder {
    color: var(--muted);
    transition: color var(--transition-normal);
  }
  
  .search-area input:focus {
    outline: none;
    border-color: var(--accent);
    background: rgba(255, 255, 255, 1);
    box-shadow: var(--shadow-colored);
    transform: translateY(-2px);
  }
  
  .search-area input:focus::placeholder {
    color: transparent;
  }
  
  .search-area input:focus + ::before {
    color: var(--accent);
    transform: translateY(-50%) scale(1.1);
  }
  
  /* Enhanced Actions */
  .actions {
    display: flex;
    gap: 12px;
    align-items: center;
    animation: slideInRight 1s var(--transition-slow) 0.5s both;
  }
  
  .actions select {
    padding: 12px 16px;
    border-radius: var(--radius);
    border: 2px solid transparent;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    cursor: pointer;
    font-weight: 500;
    transition: all var(--transition-normal);
    box-shadow: var(--shadow-sm);
  }
  
  .actions select:hover {
    border-color: var(--accent);
    background: white;
    transform: translateY(-2px);
    box-shadow: var(--shadow);
  }
  
  .actions select:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: var(--shadow-colored);
  }
  
  .cart-btn {
    position: relative;
    padding: 12px 20px;
    border-radius: var(--radius);
    border: 2px solid transparent;
    background: var(--accent);
    color: white;
    cursor: pointer;
    font-weight: 600;
    transition: all var(--transition-bounce);
    overflow: hidden;
    box-shadow: var(--shadow);
  }
  
  .cart-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
  }
  
  .cart-btn:hover {
    background: var(--accent-secondary);
    transform: translateY(-3px) scale(1.05);
    box-shadow: var(--shadow-hover);
  }
  
  .cart-btn:hover::before {
    left: 100%;
  }
  
  .cart-btn:active {
    transform: translateY(-1px) scale(1.02);
  }
  
  .cart-count {
    background: white;
    color: var(--accent);
    padding: 4px 8px;
    border-radius: 50px;
    margin-left: 8px;
    font-size: 12px;
    font-weight: 700;
    min-width: 20px;
    text-align: center;
    transition: all var(--transition-bounce);
    animation: pulse 0.6s ease-in-out;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }
  
  .cart-count:not(:empty) {
    animation: bounce 0.6s var(--transition-bounce);
  }
  
  /* Enhanced Hero Section */
  .hero {
    padding: 60px 0;
    text-align: center;
    background: radial-gradient(ellipse at center, rgba(59, 130, 246, 0.05) 0%, transparent 70%);
    animation: slideInUp 1.2s var(--transition-slow) 0.7s both;
    position: relative;
    overflow: hidden;
    z-index: 1;
  }
  
  .hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%233b82f6" fill-opacity="0.05"><circle cx="30" cy="30" r="2"/></g></svg>') repeat;
    animation: float 6s ease-in-out infinite;
    z-index: -1;
  }
  
  .hero h1 {
    margin: 12px 0;
    font-size: clamp(32px, 5vw, 48px);
    font-weight: 900;
    background: var(--accent-gradient);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: slideInUp 1.4s var(--transition-slow) 0.9s both, shimmer 3s ease-in-out infinite;
    letter-spacing: -0.03em;
    line-height: 1.2;
  }
  
  .hero p {
    color: var(--text-secondary);
    font-size: 18px;
    font-weight: 400;
    margin: 0 0 32px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    animation: slideInUp 1.6s var(--transition-slow) 1.1s both;
    line-height: 1.6;
  }
  
  /* Enhanced Products Grid */
  .products-grid {
    display: grid;
    gap: 24px;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    margin: 40px 0 100px;
    animation: slideInUp 1.2s var(--transition-slow) 1.3s both;
    position: relative; z-index:1; /* needed for ::before overlay in glass mode */
  }
  
  .card {
    background: var(--card);
    border-radius: var(--radius-lg);
    padding: 20px;
    box-shadow: var(--shadow);
    display: flex;
    flex-direction: column;
    gap: 12px;
    transition: all var(--transition-slow);
    opacity: 0;
    transform: translateY(30px) rotateX(10deg);
    animation: cardSlideIn 0.8s var(--transition-slow) forwards;
    border: 1px solid rgba(59, 130, 246, 0.05);
    position: relative;
    overflow: hidden;
  }
  
  @keyframes cardSlideIn {
    0% {
      opacity: 0;
      transform: translateY(30px) rotateX(10deg);
    }
    100% {
      opacity: 1;
      transform: translateY(0) rotateX(0deg);
    }
  }
  
  .card:nth-child(1) { animation-delay: 0.1s; }
  .card:nth-child(2) { animation-delay: 0.2s; }
  .card:nth-child(3) { animation-delay: 0.3s; }
  .card:nth-child(4) { animation-delay: 0.4s; }
  .card:nth-child(5) { animation-delay: 0.5s; }
  .card:nth-child(6) { animation-delay: 0.6s; }
  .card:nth-child(n+7) { animation-delay: 0.7s; }
  
  .card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    transition: left 0.5s ease;
    z-index: 1;
  }
  
  .card:hover {
    transform: translateY(-12px) scale(1.03);
    box-shadow: var(--shadow-hover);
    border-color: rgba(59, 130, 246, 0.2);
    background: var(--card-hover);
  }
  
  .card:hover::before {
    left: 100%;
  }
  .card img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: var(--radius);
    transition: all var(--transition-slow);
    z-index: 2;
    position: relative;
  }
  
  .card:hover img {
    transform: scale(1.08) rotate(2deg);
    box-shadow: var(--shadow-lg);
  }
  
  .card h3 {
    margin: 8px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-primary);
    transition: all var(--transition-normal);
    z-index: 2;
    position: relative;
  }
  
  .card:hover h3 {
    color: var(--accent);
    transform: translateY(-2px);
  }
  
  .card .price {
    font-weight: 700;
    font-size: 20px;
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    transition: all var(--transition-bounce);
    z-index: 2;
    position: relative;
  }
  
  .card:hover .price {
    transform: scale(1.1) translateY(-2px);
    filter: drop-shadow(0 2px 4px rgba(59, 130, 246, 0.3));
  }
  
  .card .meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: var(--muted);
    font-size: 14px;
    padding: 8px 0;
    z-index: 2;
    position: relative;
  }
  
  .card .btn {
    margin-top: auto;
    padding: 12px 16px;
    border-radius: var(--radius);
    border: 0;
    cursor: pointer;
    font-weight: 600;
    transition: all var(--transition-bounce);
    z-index: 2;
    position: relative;
  }
  
  .card .btn:hover {
    transform: translateY(-4px) scale(1.05);
    box-shadow: var(--shadow-colored);
  }
  /* Inline add-to-cart feedback */
  .inline-feedback {
    font-size:11.5px;
    font-weight:600;
    margin-left:6px;
    padding:6px 10px;
    border-radius:999px;
    background:rgba(16,185,129,0.12);
    color:var(--success);
    border:1px solid rgba(16,185,129,0.35);
    opacity:0;
    transform:translateY(-4px) scale(.9);
    transition:opacity .35s var(--transition-fast), transform .45s var(--transition-bounce);
    display:inline-flex;
    align-items:center;
    gap:8px;
    pointer-events:auto;
    white-space:nowrap;
  }
  .inline-feedback.show { opacity:1; transform:translateY(0) scale(1); }
  .inline-feedback.error { background:rgba(239,68,68,0.12); color:var(--error); border-color:rgba(239,68,68,0.4); }
  .inline-feedback.removed { background:rgba(239,68,68,0.12); color:var(--error); border-color:rgba(239,68,68,0.45); }
  .inline-feedback .undo { background:none; border:0; color:var(--accent); cursor:pointer; font-weight:700; font-size:11px; padding:0; }
  .inline-feedback .undo:hover { text-decoration:underline; }
  /* Enhanced Buttons */
  .btn {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(59, 130, 246, 0.1);
    padding: 12px 24px;
    border-radius: var(--radius);
    cursor: pointer;
    font-weight: 600;
    transition: all var(--transition-bounce);
    position: relative;
    overflow: hidden;
    text-decoration: none;
    display: inline-block;
    text-align: center;
    box-shadow: var(--shadow-sm);
  }
  
  .btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s ease;
  }
  
  .btn:hover {
    transform: translateY(-4px) scale(1.05);
    box-shadow: var(--shadow);
    border-color: var(--accent);
    background: white;
  }
  
  .btn:hover::before {
    left: 100%;
  }
  
  .btn:active {
    transform: translateY(-2px) scale(1.02);
  }
  
  .btn.primary {
    background: var(--accent-gradient);
    color: white;
    border-color: transparent;
    box-shadow: var(--shadow-colored);
  }
  
  .btn.primary::before {
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  }
  
  .btn.primary:hover {
    background: var(--accent-gradient);
    background-size: 200% 200%;
    animation: shimmer 1s ease-in-out;
    box-shadow: var(--shadow-hover);
    transform: translateY(-6px) scale(1.05);
    color: white;
  }
  
  
  /* Enhanced Cart Panel */
  .cart-panel {
    position: fixed;
    right: 24px;
    bottom: 24px;
    width: 380px;
    max-height: 80vh;
    background: var(--card);
    border-radius: var(--radius-lg);
    padding: 0;
    box-shadow: var(--shadow-hover);
    border: 2px solid rgba(59, 130, 246, 0.1);
    transform: translateY(40px) scale(0.9) rotateX(10deg);
    opacity: 0;
    pointer-events: none;
    transition: all var(--transition-slow);
    z-index: 500;
    backdrop-filter: blur(20px);
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }
  
  .cart-panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--accent-gradient);
    z-index: 1;
  }
  
  .cart-panel[aria-hidden="false"] {
    transform: translateY(0) scale(1) rotateX(0deg);
    opacity: 1;
    pointer-events: auto;
    animation: cartSlideIn 0.6s var(--transition-bounce);
  }
  
  @keyframes cartSlideIn {
    0% {
      transform: translateY(40px) scale(0.9) rotateX(10deg);
      opacity: 0;
    }
    50% {
      transform: translateY(-5px) scale(1.02) rotateX(-2deg);
    }
    100% {
      transform: translateY(0) scale(1) rotateX(0deg);
      opacity: 1;
    }
  }
  .cart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid rgba(59, 130, 246, 0.1);
    background: var(--accent-gradient);
    color: white;
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
    position: relative;
    z-index: 2;
  }
  
  .cart-header h3 {
    font-size: 18px;
    font-weight: 700;
    margin: 0;
  }
  
  .cart-header .close {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    color: white;
    border: 2px solid transparent;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-bounce);
    font-size: 18px;
    font-weight: bold;
  }
  
  .cart-header .close:hover {
    background: rgba(255, 255, 255, 0.3);
    border-color: white;
    transform: scale(1.15) rotate(90deg);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }
  
  .cart-header .close:active {
    transform: scale(1.05) rotate(90deg);
  }
  .cart-items {
    flex: 1;
    overflow-y: auto;
    padding: 20px 20px 8px;
    scrollbar-width: thin;
    scrollbar-color: var(--accent) transparent;
    min-height: 120px;
  }
  
  .cart-items::-webkit-scrollbar {
    width: 6px;
  }
  
  .cart-items::-webkit-scrollbar-track {
    background: rgba(59, 130, 246, 0.1);
    border-radius: 3px;
  }
  
  .cart-items::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 3px;
  }
  
  .cart-item {
    display: flex;
    gap: 16px;
    align-items: center;
    padding: 16px;
    border-radius: var(--radius);
    transition: all var(--transition-normal);
    border: 2px solid transparent;
    margin-bottom: 12px;
    background: rgba(59, 130, 246, 0.02);
  }
  
  .cart-item:hover {
    background: rgba(59, 130, 246, 0.08);
    border-color: rgba(59, 130, 246, 0.2);
    transform: translateX(8px) translateY(-2px);
    box-shadow: var(--shadow);
  }
  
  .cart-item img {
    width: 64px;
    height: 64px;
    object-fit: cover;
    border-radius: var(--radius-sm);
    transition: all var(--transition-normal);
    box-shadow: var(--shadow-sm);
  }
  
  .cart-item:hover img {
    transform: scale(1.1) rotate(5deg);
    box-shadow: var(--shadow);
  }
  
  .cart-item .info {
    flex: 1;
  }
  
  .cart-item .info h4 {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 4px 0;
  }
  
  .cart-item .info .price {
    font-size: 16px;
    font-weight: 700;
    color: var(--accent);
  }
  
  .cart-item .qty {
    display: flex;
    gap: 8px;
    align-items: center;
  }
  
  /* Quantity controls refined */
  .qty-btn {
    width: 32px;
    height: 32px;
    padding: 0;
    border-radius: 12px;
    border: 2px solid var(--accent);
    background: rgba(255,255,255,0.9);
    color: var(--accent);
    font-weight: 700;
    font-size: 16px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
    line-height: 1;
  }
  .qty-btn:hover { background: var(--accent); color:#fff; transform: translateY(-2px); }
  .qty-btn:active { transform: translateY(0); }

  .cart-item .qty input.cart-qty {
    height: 32px;
    padding: 4px 6px;
    border-radius: 10px;
    border: 2px solid rgba(59,130,246,0.25);
    font-weight:600;
    text-align:center;
    width: 60px !important;
  }
  .cart-item .qty input.cart-qty:focus { border-color: var(--accent); }

  .btn.small { padding:6px 14px; font-size:12px; border-radius: 10px; }
  .btn.small:hover { transform: translateY(-2px) scale(1.03); }
  .btn.small:active { transform: translateY(-1px); }

  .cart-item .qty { gap:8px; }
  .cart-footer {
    padding: 20px 24px;
    border-top: 1px solid rgba(59, 130, 246, 0.1);
    background: linear-gradient(135deg, rgba(248, 250, 252, 0.8), rgba(241, 245, 249, 0.8));
    backdrop-filter: blur(10px);
    border-radius: 0 0 var(--radius-lg) var(--radius-lg);
  }
  
  .totals {
    display: flex;
    justify-content: space-between;
    margin-bottom: 16px;
    font-weight: 700;
    font-size: 18px;
    color: var(--text-primary);
    padding: 12px 0;
    border-bottom: 2px solid rgba(59, 130, 246, 0.1);
  }
  
  .totals div:last-child {
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-size: 20px;
  }
  
  .cart-footer .btn {
    width: 100%;
    margin-bottom: 8px;
    justify-content: center;
  }
  
  .cart-footer .btn:last-child {
    margin-bottom: 0;
  }
  
  /* Enhanced Footer */
  .site-footer {
    padding: 40px 0;
    border-top: 1px solid rgba(59, 130, 246, 0.1);
    margin-top: 80px;
    color: var(--text-secondary);
    background: linear-gradient(135deg, rgba(248, 250, 252, 0.8), rgba(241, 245, 249, 0.8));
    backdrop-filter: blur(20px);
    animation: slideInUp 1s var(--transition-slow) 1.4s both;
    position: relative;
  }
  
  .site-footer::before {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100px;
    height: 4px;
    background: var(--accent-gradient);
    border-radius: 0 0 50px 50px;
  }
  
  .site-footer .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 20px;
  }
  
  .site-footer .footer-links {
    display: flex;
    gap: 24px;
  }
  
  .site-footer a {
    transition: all var(--transition-normal);
    text-decoration: none;
    color: var(--text-secondary);
    font-weight: 500;
    padding: 8px 16px;
    border-radius: var(--radius);
    border: 2px solid transparent;
  }
  
  .site-footer a:hover {
    color: var(--accent);
    background: rgba(59, 130, 246, 0.1);
    border-color: rgba(59, 130, 246, 0.2);
    transform: translateY(-2px);
    box-shadow: var(--shadow-sm);
  }
  
  /* Enhanced Responsive Design */
  @media (max-width: 768px) {
    .modal-body {
      flex-direction: column;
      gap: 20px;
    }
    
    .modal-body img {
      width: 100%;
      height: 280px;
    }
    
    .modal-info {
      width: 100%;
      padding-left: 0;
    }
    
    .actions {
      display: none;
    }
    
    .cart-panel {
      right: 12px;
      bottom: 12px;
      width: calc(100vw - 24px);
      max-width: 360px;
    }
    
    .hero h1 {
      font-size: 32px;
    }
    
    .hero p {
      font-size: 16px;
    }
    
    .products-grid {
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 16px;
    }
  }

  @media (max-width: 480px) {
    .header-inner {
      gap: 12px;
      padding: 12px 0;
    }
    
    .brand {
      font-size: 20px;
    }
    
    .hero {
      padding: 40px 0;
    }
    
    .container {
      padding: 0 12px;
    }
    
    .products-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Performance Optimizations */
  .card, .btn, .search-area input, .modal-content {
    will-change: transform;
  }

  /* Utility Animations */
  .animate-in {
    animation: slideInUp 0.6s var(--transition-slow);
  }

  .loading {
    position: relative;
  }

  .loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 24px;
    height: 24px;
    margin: -12px 0 0 -12px;
    border: 3px solid rgba(59, 130, 246, 0.1);
    border-top: 3px solid var(--accent);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Accessibility & Motion Preferences */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  @media (prefers-reduced-motion: no-preference) {
    .container {
      animation: slideInUp 0.8s var(--transition-slow);
    }
  }

  /* Enhanced Focus States */
  *:focus {
    outline: 3px solid var(--accent);
    outline-offset: 2px;
    transition: outline var(--transition-fast);
  }

/* --- Modal Reset Override (ensures visibility & centering) --- */
#productModal.modal { 
  position: fixed; inset:0; display:none; align-items:center; justify-content:center; 
  background: rgba(15,23,42,0.55); backdrop-filter: blur(10px); z-index: 2000; padding: 32px; 
}
#productModal[aria-hidden="false"] { display:flex !important; }
#productModal .modal-content { 
  position: relative; margin:0 auto; width:100%; max-width: 960px; background: var(--card); 
  border-radius: 20px; padding: 40px 40px 32px; box-shadow: var(--shadow-hover); 
  animation: modalCenterIn .35s ease; transform-origin: center; 
  max-height: calc(100vh - 120px); overflow:auto; overscroll-behavior:contain; 
}
@keyframes modalCenterIn { 
  0% { opacity:0; transform: scale(.85) translateY(30px); } 
  60% { opacity:1; transform: scale(1.02) translateY(-4px); } 
  100% { opacity:1; transform: scale(1) translateY(0); } 
}
#productModal .modal-body { flex-wrap:nowrap; }
@media (max-width:900px){
  #productModal .modal-body { flex-direction:column; }
  #productModal .modal-body img, #productModal .modal-info { width:100% !important; }
}

/* Fallback: if old 'positioned' class somehow remains, force centering */
#productModal.positioned { align-items:center !important; justify-content:center !important; }
#productModal.positioned .modal-content { left:auto !important; top:auto !important; transform:none !important; }

/* Centered modal (consolidated) */
#productModal[aria-hidden="false"] .modal-content {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  margin: 0;
  animation: none; /* animation handled via JS FLIP */
  will-change: transform, opacity;
}

#productModal[aria-hidden="false"] .modal-content.closing { pointer-events:none; }


  .btn:focus,
  .cart-btn:focus,
  .close:focus {
    outline-color: white;
    box-shadow: 0 0 0 3px var(--accent);
  }

  /* ---------------- Glass Mode Cart Contrast Fixes ---------------- */
  /* Local variable overrides so cart uses light text on dark site without affecting rest */
  body.glass-mode .cart-panel {
    --text-primary: #0f172a;
    --text-secondary: #475569;
    --muted: #64748b;
    background: rgba(255,255,255,0.58);
    box-shadow: 0 28px 60px -20px rgba(0,0,0,0.55), 0 2px 6px rgba(0,0,0,0.25);
    backdrop-filter: blur(26px) saturate(200%);
    -webkit-backdrop-filter: blur(26px) saturate(200%);
    border: 1px solid rgba(255,255,255,0.55);
  }
  body.glass-mode .cart-panel .cart-header { color:#fff; }
  body.glass-mode .cart-panel .cart-header h3 { color:#fff; text-shadow:0 2px 4px rgba(0,0,0,0.25); }
  body.glass-mode .cart-panel .cart-header .close { color:#fff; }
  body.glass-mode .cart-item { background: rgba(255,255,255,0.55); color: var(--text-secondary); border:1px solid rgba(0,0,0,0.05); box-shadow:0 4px 18px -6px rgba(0,0,0,0.25) inset, 0 2px 6px -2px rgba(0,0,0,0.12); }
  body.glass-mode .cart-item:hover { background: rgba(255,255,255,0.75); border-color: rgba(0,0,0,0.12); }
  body.glass-mode .cart-item .info > div:first-child { color:#0f172a; font-weight:700; }
  body.glass-mode .cart-item .info .price { color: var(--accent); font-weight:600; }
  body.glass-mode .cart-item .qty input.cart-qty { background: rgba(255,255,255,0.85); color:#0f172a; border:2px solid rgba(59,130,246,0.35); box-shadow:0 2px 4px rgba(0,0,0,0.08) inset; }
  body.glass-mode .cart-item .qty input.cart-qty:focus { background:#fff; border-color: var(--accent); }
  body.glass-mode .qty-btn { background:#fff; color:var(--accent); border:2px solid var(--accent); }
  body.glass-mode .qty-btn:hover { background: var(--accent); color:#fff; }
  body.glass-mode .totals { color:#0f172a; border-bottom:2px solid rgba(0,0,0,0.08); }
  body.glass-mode .totals div:last-child { filter:none; }
  body.glass-mode .cart-footer { background: linear-gradient(135deg, rgba(255,255,255,0.65), rgba(255,255,255,0.45)); backdrop-filter: blur(12px) saturate(180%); }
  body.glass-mode .cart-footer .btn { background: rgba(255,255,255,0.85); color:#0f172a; border:2px solid rgba(59,130,246,0.25); }
  body.glass-mode .cart-footer .btn:hover { background:#fff; border-color: var(--accent); }
  body.glass-mode .cart-footer .btn.primary { background: var(--accent-gradient); color:#fff; border:0; box-shadow:0 6px 18px -4px rgba(59,130,246,0.55); }
  body.glass-mode .cart-footer .btn.primary:hover { box-shadow:0 10px 30px -6px rgba(59,130,246,0.65); }
  body.glass-mode .cart-items::-webkit-scrollbar-track { background: rgba(0,0,0,0.08); }
  body.glass-mode .cart-items::-webkit-scrollbar-thumb { background: linear-gradient(180deg,#3b82f6,#8b5cf6); }
  body.glass-mode .cart-panel .notification { color:#fff; }
  /* Ensure product meta paragraph within cart (if any) has proper contrast */
  body.glass-mode .cart-panel p { color: var(--text-secondary); }
  /* Custom Dialog & Toast */
  .ui-dialog-root { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none; z-index:4000; }
  .ui-dialog-root.visible { pointer-events:auto; }
  .ui-dialog-overlay { position:absolute; inset:0; background:rgba(15,23,42,0.45); backdrop-filter:blur(10px); opacity:0; animation: fadeIn .35s forwards; }
  .ui-dialog { position:relative; max-width:420px; width:calc(100% - 32px); background:var(--card); border-radius:24px; padding:34px 34px 30px; box-shadow:0 28px 60px -20px rgba(15,23,42,.35), var(--shadow); border:1px solid rgba(59,130,246,0.15); transform: translateY(24px) scale(.96); animation: dialogIn .5s var(--transition-bounce) forwards; }
  @keyframes dialogIn { 0% { opacity:0; transform:translateY(38px) scale(.9) rotateX(8deg); } 60% { opacity:1; transform:translateY(-6px) scale(1.015); } 100% { opacity:1; transform:translateY(0) scale(1); } }
  .ui-dialog h3 { margin:0 0 8px; font-size:22px; font-weight:700; letter-spacing:-0.02em; }
  .ui-dialog p { margin:0 0 22px; font-size:15px; line-height:1.5; color:var(--text-secondary); }
  .ui-dialog .actions { display:flex; gap:12px; justify-content:flex-end; }
  .ui-dialog .actions .btn { flex:0 0 auto; }
  .ui-dialog .actions .btn.primary.destructive { background:linear-gradient(135deg,#ef4444,#f87171); box-shadow:0 6px 20px -6px rgba(239,68,68,.55); }
  .ui-dialog .close-x { position:absolute; top:10px; right:10px; background:rgba(59,130,246,0.12); border:0; width:36px; height:36px; border-radius:50%; cursor:pointer; font-size:20px; font-weight:700; line-height:1; color:var(--accent); display:flex; align-items:center; justify-content:center; }
  .ui-dialog .close-x:hover { background:var(--accent-gradient); color:#fff; }
  .toast-stack { position:fixed; top:16px; right:16px; display:flex; flex-direction:column; gap:10px; z-index:4100; max-width:340px; }
  .toast { background:var(--card); border:1px solid rgba(59,130,246,0.2); padding:14px 18px; border-radius:14px; font-size:14px; font-weight:500; box-shadow:var(--shadow); display:flex; gap:10px; align-items:flex-start; animation: fadeIn .4s ease, slideInUp .6s ease; position:relative; overflow:hidden; }
  .toast.success { border-color:rgba(16,185,129,0.4); }
  .toast::after { content:''; position:absolute; left:0; bottom:0; height:3px; width:100%; background:var(--accent-gradient); animation: toastBar 4s linear forwards; }
  @keyframes toastBar { to { width:0; } }
  .toast button { margin-left:auto; background:none; border:0; color:var(--accent); font-weight:600; cursor:pointer; }
  .toast button:hover { text-decoration:underline; }
  /* Ensure 'Remove' button text visible inside cart items */
  body.glass-mode .cart-item .btn.small { 
    background: rgba(255,255,255,0.9); 
    color: #0f172a !important; 
    border:2px solid rgba(59,130,246,0.25); 
    box-shadow:0 2px 4px rgba(0,0,0,0.08); 
  }
  body.glass-mode .cart-item .btn.small:hover { 
    background:#fff; 
    border-color: var(--accent); 
    color:#0f172a; 
    box-shadow:0 4px 10px -2px rgba(0,0,0,0.18); 
  }
  body.glass-mode .cart-item .btn.small:active { 
    transform: translateY(-1px) scale(1.02); 
  }

  /* ------------------------------------------------------------ */
  /* Glass Mode Readability & Contrast Enhancements (accessibility)
     Addresses low-contrast small / secondary text reported by user. */
  body.glass-mode { --glass-panel-strength: rgba(255,255,255,0.24); }
  body.glass-mode .panel,
  body.glass-mode .cart-panel,
  body.glass-mode .ui-dialog,
  body.glass-mode .modal-content {
    background: linear-gradient(145deg, rgba(255,255,255,0.30), rgba(255,255,255,0.18)) !important;
    backdrop-filter: blur(26px) saturate(185%) !important;
    -webkit-backdrop-filter: blur(26px) saturate(185%) !important;
    border:1px solid rgba(255,255,255,0.28) !important;
  }
  /* Elevate checkout side summary specifically (if it uses .panel) */
  body.glass-mode .order-summary.panel { box-shadow:0 18px 46px -18px rgba(0,0,0,0.65), var(--shadow); }
  /* Heading & structural text clarity */
  body.glass-mode .panel h1,
  body.glass-mode .panel h2,
  body.glass-mode .panel h3,
  body.glass-mode .ui-dialog h3 { color:#fff; text-shadow:0 2px 6px rgba(0,0,0,0.45); }
  /* Secondary / muted copy inside glass surfaces */
  body.glass-mode .panel p,
  body.glass-mode .panel .inline-note,
  body.glass-mode .panel .secure-badge,
  body.glass-mode .panel .field label,
  body.glass-mode .ui-dialog p,
  body.glass-mode .summary-item .meta .q { color: rgba(255,255,255,0.83) !important; }
  /* Ensure quantitative / emphasis text remains vivid */
  body.glass-mode .summary-item .price,
  body.glass-mode #reviewTotal,
  body.glass-mode #sumTotal { filter:drop-shadow(0 2px 4px rgba(0,0,0,0.45)); }
  /* Form fields inside glass panels */
  body.glass-mode .panel .field input,
  body.glass-mode .panel .field select,
  body.glass-mode .panel .field textarea { background: rgba(255,255,255,0.92); color:#0f172a; border:2px solid rgba(255,255,255,0.65); }
  body.glass-mode .panel .field input:focus,
  body.glass-mode .panel .field select:focus,
  body.glass-mode .panel .field textarea:focus { border-color: var(--accent); box-shadow:0 0 0 3px rgba(59,130,246,0.55); background:#fff; }
  /* Buttons: keep non-primary buttons clearly legible */
  body.glass-mode .panel .btn:not(.primary) { background: rgba(255,255,255,0.9); color:#0f172a; border:2px solid rgba(59,130,246,0.28); }
  body.glass-mode .panel .btn:not(.primary):hover { background:#fff; border-color: var(--accent); }
  /* Dialog specific elevating ring */
  body.glass-mode .ui-dialog { box-shadow:0 28px 72px -18px rgba(0,0,0,0.85), 0 0 0 1px rgba(255,255,255,0.08) inset; }
  body.glass-mode .ui-dialog .close-x { background:rgba(255,255,255,0.18); color:#fff; }
  body.glass-mode .ui-dialog .close-x:hover { background: var(--accent-gradient); color:#fff; }
  /* Tiny text (badges / labels) strengthen contrast */
  body.glass-mode .badge-pill,
  body.glass-mode .steps .step.active { box-shadow:0 4px 14px -4px rgba(0,0,0,0.6); }
  /* Edge: ensure error messages remain visible */
  body.glass-mode .field.error .err-msg { color:#ef4444; text-shadow:0 1px 2px rgba(0,0,0,0.5); }
  /* Accessibility: prefers-contrast users get even stronger surfaces */
  @media (prefers-contrast: more) {
    body.glass-mode .panel,
    body.glass-mode .cart-panel,
    body.glass-mode .ui-dialog,
    body.glass-mode .modal-content { background: rgba(15,23,42,0.78) !important; border-color:rgba(255,255,255,0.38) !important; }
    body.glass-mode .panel p,
    body.glass-mode .panel .field label { color:#f1f5f9 !important; }
  }
  /* Reduce motion: skip heavy blur transitions if any were added later */
  @media (prefers-reduced-motion: reduce) { body.glass-mode .panel, body.glass-mode .ui-dialog { transition:none; } }

  /* Dialog sub-note (replaces inline style) */
  .ui-dialog .dialog-subnote { color: var(--muted); font-weight:500; display:inline-block; margin-top:4px; }
  body.glass-mode .ui-dialog .dialog-subnote { color: rgba(255,255,255,0.85); font-weight:600; text-shadow:0 1px 3px rgba(0,0,0,0.55); }

  /* Terms Popover */
  .popover-terms { position:absolute; z-index:5000; width:min(380px, calc(100vw - 32px)); background:var(--card); border:1px solid rgba(59,130,246,0.18); border-radius:20px; box-shadow:0 18px 48px -14px rgba(15,23,42,0.4), var(--shadow); animation: popIn .4s var(--transition-bounce) both; }
  .popover-terms .pop-inner { display:flex; flex-direction:column; max-height:60vh; }
  .popover-terms .pop-header { display:flex; align-items:center; justify-content:space-between; padding:18px 22px 10px; }
  .popover-terms h3 { font-size:18px; margin:0; letter-spacing:-0.5px; }
  .popover-terms .close-x { background:rgba(59,130,246,0.12); border:0; width:32px; height:32px; border-radius:12px; cursor:pointer; font-size:18px; font-weight:700; color:var(--accent); display:flex; align-items:center; justify-content:center; transition:background .25s; }
  .popover-terms .close-x:hover { background:var(--accent-gradient); color:#fff; }
  .popover-terms .pop-body { padding:0 22px 18px; overflow:auto; scrollbar-width:thin; }
  .popover-terms .pop-body::-webkit-scrollbar { width:8px; }
  .popover-terms .pop-body::-webkit-scrollbar-track { background:transparent; }
  .popover-terms .pop-body::-webkit-scrollbar-thumb { background:linear-gradient(var(--accent), var(--accent-secondary)); border-radius:20px; opacity:.7; }
  .popover-terms p { font-size:14px; line-height:1.5; margin:0 0 12px; color:var(--text-secondary); }
  .popover-terms ul.mini-list { list-style:none; margin:0 0 14px; padding:0; display:grid; gap:6px; }
  .popover-terms ul.mini-list li { background:var(--card-hover); padding:8px 10px; border-radius:10px; font-size:13px; line-height:1.4; box-shadow:0 2px 6px rgba(15,23,42,0.06); }
  .popover-terms .fine-print { font-size:11px !important; color:var(--muted); display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
  .popover-terms .fine-print .btn.small { padding:4px 10px; font-size:11px; }
  .popover-terms.below::after, .popover-terms:not(.below)::after { content:""; position:absolute; width:14px; height:14px; background:var(--card); border:1px solid rgba(59,130,246,0.18); transform:rotate(45deg); }
  .popover-terms:not(.below)::after { bottom:-7px; left:50%; margin-left:-7px; box-shadow:0 10px 20px -6px rgba(15,23,42,0.3); }
  .popover-terms.below::after { top:-7px; left:50%; margin-left:-7px; box-shadow:0 -6px 18px -4px rgba(15,23,42,0.3); }
  @keyframes popIn { 0% { opacity:0; transform:translateY(8px) scale(.96); } 100% { opacity:1; transform:translateY(0) scale(1); } }
  body.glass-mode .popover-terms { backdrop-filter:blur(14px) saturate(160%); -webkit-backdrop-filter:blur(14px) saturate(160%); background:rgba(255,255,255,0.18); border:1px solid rgba(255,255,255,0.25); box-shadow:0 18px 60px -16px rgba(0,0,0,0.65), 0 0 0 1px rgba(255,255,255,0.1) inset; }
  body.glass-mode .popover-terms ul.mini-list li { background:rgba(255,255,255,0.25); }
  body.glass-mode .popover-terms::after { background:rgba(255,255,255,0.18); border:1px solid rgba(255,255,255,0.3); }
  /* Backdrop effect when popover open */
  body.terms-popover-open .bg-fx { filter:blur(6px) brightness(.8) saturate(.9); transition:filter .4s ease; }
  body.terms-popover-open main, body.terms-popover-open header, body.terms-popover-open footer { filter:blur(2px) opacity(.85); transition:filter .35s ease; }
  /* Mirror effect for contact popover */
  body.contact-popover-open .bg-fx { filter:blur(6px) brightness(.8) saturate(.9); transition:filter .4s ease; }
  body.contact-popover-open main, body.contact-popover-open header, body.contact-popover-open footer { filter:blur(2px) opacity(.85); transition:filter .35s ease; }
  .popover-terms { isolation:isolate; }
  /* Strengthen readability in glass mode */
  body.glass-mode .popover-terms { background:rgba(15,23,42,0.55); backdrop-filter:blur(18px) saturate(180%); -webkit-backdrop-filter:blur(18px) saturate(180%); }
  body.glass-mode .popover-terms h3 { color:#fff; text-shadow:0 2px 6px rgba(0,0,0,.5); }
  body.glass-mode .popover-terms p, body.glass-mode .popover-terms li { color:rgba(255,255,255,0.88); text-shadow:0 1px 3px rgba(0,0,0,.4); }

  /* Contact Popover (shares many styles) */
  .popover-contact { position:absolute; z-index:5000; width:min(400px, calc(100vw - 32px)); background:var(--card); border:1px solid rgba(59,130,246,0.18); border-radius:22px; box-shadow:0 18px 48px -14px rgba(15,23,42,0.4), var(--shadow); animation: popIn .4s var(--transition-bounce) both; isolation:isolate; }
  .popover-contact .pop-inner { display:flex; flex-direction:column; max-height:62vh; }
  .popover-contact .pop-header { display:flex; align-items:center; justify-content:space-between; padding:18px 22px 6px; }
  .popover-contact h3 { font-size:19px; margin:0; letter-spacing:-0.5px; }
  .popover-contact .close-x { background:rgba(59,130,246,0.12); border:0; width:32px; height:32px; border-radius:12px; cursor:pointer; font-size:18px; font-weight:700; color:var(--accent); display:flex; align-items:center; justify-content:center; transition:background .25s; }
  .popover-contact .close-x:hover { background:var(--accent-gradient); color:#fff; }
  .popover-contact form { padding:0 22px 20px; overflow:auto; }
  .popover-contact form .field { display:flex; flex-direction:column; gap:6px; margin:0 0 14px; }
  .popover-contact form label { font-size:12px; text-transform:uppercase; letter-spacing:.08em; font-weight:600; color:var(--muted); }
  .popover-contact form input, .popover-contact form textarea { font:inherit; padding:10px 12px; border-radius:12px; border:1px solid rgba(59,130,246,0.25); background:var(--card-hover); outline:none; transition:border .25s, box-shadow .25s; resize:vertical; }
  .popover-contact form input:focus, .popover-contact form textarea:focus { border-color:var(--accent); box-shadow:0 0 0 3px rgba(59,130,246,0.25); }
  .popover-contact form input.invalid, .popover-contact form textarea.invalid { border-color:var(--error); box-shadow:0 0 0 3px rgba(239,68,68,.25); }
  .popover-contact form .err { font-size:11px; color:var(--error); font-weight:600; margin-top:-4px; }
  .popover-contact .helper-links { display:flex; flex-wrap:wrap; gap:10px; margin:4px 0 10px; }
  .popover-contact .helper-links a { font-size:12px; color:var(--accent); text-decoration:none; background:var(--accent-soft); padding:6px 10px; border-radius:10px; transition:background .25s; }
  .popover-contact .helper-links a:hover { background:var(--accent-gradient); color:#fff; }
  .popover-contact .actions-row { display:flex; gap:10px; align-items:center; margin:4px 0 10px; }
  .popover-contact .fine-print { font-size:11px; color:var(--muted); margin:4px 0 0; }
  .popover-contact.below::after, .popover-contact:not(.below)::after { content:""; position:absolute; width:14px; height:14px; background:var(--card); border:1px solid rgba(59,130,246,0.18); transform:rotate(45deg); }
  .popover-contact:not(.below)::after { bottom:-7px; left:50%; margin-left:-7px; box-shadow:0 10px 20px -6px rgba(15,23,42,0.3); }
  .popover-contact.below::after { top:-7px; left:50%; margin-left:-7px; box-shadow:0 -6px 18px -4px rgba(15,23,42,0.3); }
  body.glass-mode .popover-contact { background:rgba(15,23,42,0.55); backdrop-filter:blur(18px) saturate(180%); -webkit-backdrop-filter:blur(18px) saturate(180%); border:1px solid rgba(255,255,255,0.25); box-shadow:0 18px 60px -16px rgba(0,0,0,0.65), 0 0 0 1px rgba(255,255,255,0.1) inset; }
  body.glass-mode .popover-contact::after { background:rgba(15,23,42,0.55); border:1px solid rgba(255,255,255,0.25); }
  body.glass-mode .popover-contact h3 { color:#fff; text-shadow:0 2px 6px rgba(0,0,0,.5); }
  body.glass-mode .popover-contact label { color:rgba(255,255,255,0.65); }
  body.glass-mode .popover-contact input, body.glass-mode .popover-contact textarea { background:rgba(255,255,255,0.2); color:#fff; }
  body.glass-mode .popover-contact .fine-print { color:rgba(255,255,255,0.65); }
  body.glass-mode .popover-contact .helper-links a { background:rgba(255,255,255,0.2); }

/* ===== Accessibility & Readability Enhancements (Popover Contrast) ===== */
/* Stronger glass surface & higher contrast text */
body.glass-mode .popover-terms,
body.glass-mode .popover-contact {
  background: linear-gradient(135deg, rgba(15,23,42,0.82), rgba(30,41,59,0.78)) border-box;
  backdrop-filter: blur(20px) saturate(220%);
  -webkit-backdrop-filter: blur(20px) saturate(220%);
  border: 1px solid rgba(255,255,255,0.28);
}
body.glass-mode .popover-terms h3,
body.glass-mode .popover-contact h3 { color:#fff; text-shadow:0 2px 8px rgba(0,0,0,0.6); }
body.glass-mode .popover-terms p,
body.glass-mode .popover-terms li,
body.glass-mode .popover-contact p,
body.glass-mode .popover-contact label,
body.glass-mode .popover-contact .fine-print { color:rgba(255,255,255,0.92); }
body.glass-mode .popover-terms ul.mini-list li { background:rgba(255,255,255,0.18); backdrop-filter:blur(4px); -webkit-backdrop-filter:blur(4px); }
body.glass-mode .popover-contact input,
body.glass-mode .popover-contact textarea { background:rgba(255,255,255,0.24); border:1px solid rgba(255,255,255,0.38); color:#fff; }
body.glass-mode .popover-contact input:focus,
body.glass-mode .popover-contact textarea:focus { border-color:var(--accent); box-shadow:0 0 0 2px rgba(59,130,246,0.45); }
body.glass-mode .popover-contact input::placeholder,
body.glass-mode .popover-contact textarea::placeholder { color:rgba(255,255,255,0.55); }
body.glass-mode .popover-contact .err { color:#ffb4b4; text-shadow:0 1px 3px rgba(0,0,0,.4); }
/* Improve arrow diamond visibility */
body.glass-mode .popover-terms::after,
body.glass-mode .popover-contact::after { background:linear-gradient(135deg, rgba(15,23,42,0.85), rgba(37,51,73,0.8)); border:1px solid rgba(255,255,255,0.3); }

/* Normal mode slight tweak for clearer content */
.popover-terms, .popover-contact { backdrop-filter: blur(12px) saturate(150%); -webkit-backdrop-filter: blur(12px) saturate(150%); }
.popover-contact input, .popover-contact textarea { background:rgba(255,255,255,0.9); }
.popover-contact input::placeholder, .popover-contact textarea::placeholder { color: #64748b; }
  /* Cancel button contrast inside dialog for glass mode */
  body.glass-mode .ui-dialog .actions .btn:not(.primary) { background: rgba(255,255,255,0.92); color:#0f172a; border:2px solid rgba(59,130,246,0.28); box-shadow:0 2px 6px -2px rgba(0,0,0,0.4); }
  body.glass-mode .ui-dialog .actions .btn:not(.primary):hover { background:#fff; border-color: var(--accent); }
  body.glass-mode .ui-dialog .actions .btn.primary { box-shadow:0 6px 20px -6px rgba(59,130,246,0.7); }
  .ui-dialog .actions .btn:focus-visible { outline:3px solid var(--accent); outline-offset:2px; }


  /* Print Styles */
  @media print {
    .site-header,
    .cart-panel,
    .actions,
    .site-footer {
      display: none !important;
    }
    body { background: #fff !important; }
    .card { break-inside: avoid; }

  }